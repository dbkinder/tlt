<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Get Started &mdash; Intel® Transfer Learning Tool 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/tlt-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Intel® Transfer Learning Tool Supported Models" href="Models.html" />
    <link rel="prev" title="Intel® Transfer Learning Tool" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Intel® Transfer Learning Tool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Documentation Home</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Get Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#check-system-requirements">① Check System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install">② Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-intel-transfer-learning-tool">③ Run the Intel Transfer Learning Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-using-the-no-code-cli">Run Using the No-Code CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-using-the-low-code-api">Run Using the Low-Code API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-and-next-steps">Summary and Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#support">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Models.html">Supported Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="DATASETS.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="docbuild.html">Building Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Legal.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool">GitHub Repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Intel® Transfer Learning Tool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Get Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/GetStarted.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="get-started">
<h1>Get Started<a class="headerlink" href="#get-started" title="Permalink to this heading">¶</a></h1>
<p>This is a guide for getting started with Intel® Transfer Learning Tool and will
walk you through the steps to check system requirements, install, and then run
the tool with a couple of examples showing no-code CLI and low-code API
approaches.</p>
<p><img alt="alt text" src="_images/TLT-GSG_flow.png" /></p>
<section id="check-system-requirements">
<h2>① Check System Requirements<a class="headerlink" href="#check-system-requirements" title="Permalink to this heading">¶</a></h2>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Recommended Hardware</p></th>
<th class="head"><p>Precision</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Intel® 4th Gen Xeon® Scalable Performance processors</p></td>
<td><p>BF16</p></td>
</tr>
<tr class="row-odd"><td><p>Intel® 1st, 2nd, 3rd, and 4th Gen Xeon® Scalable Performance processors</p></td>
<td><p>FP32</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Required Software</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linux* system (validated on Ubuntu* 20.04/22.04 LTS)</p></td>
</tr>
<tr class="row-odd"><td><p>Python (3.8, 3.9, or 3.10)</p></td>
</tr>
<tr class="row-even"><td><p>Pip</p></td>
</tr>
<tr class="row-odd"><td><p>Conda or Python virtualenv</p></td>
</tr>
<tr class="row-even"><td><p>git (only required for advanced installation)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="install">
<h2>② Install<a class="headerlink" href="#install" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p><strong>Install Dependencies</strong></p>
<p>Install required packages using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">libgl1</span> <span class="n">libglib2</span><span class="mf">.0</span><span class="o">-</span><span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p><strong>Create and activate a Python3 virtual environment</strong></p>
<p>We encourage you to use a Python virtual environment (virtualenv or conda)
for consistent package management.  There are two ways to do this:</p>
<p>a. Use <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="n">python3</span> <span class="n">tlt_dev_venv</span>
<span class="n">source</span> <span class="n">tlt_dev_venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>b. Or use <code class="docutils literal notranslate"><span class="pre">conda</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">tlt_dev_venv</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">tlt_dev_venv</span>
</pre></div>
</div>
</li>
<li><p><strong>Install Intel Transfer Learning Tool</strong></p>
<p>Use the Basic Installation instructions unless you plan on making code changes.</p>
<p>a. <strong>Basic Installation</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">intel</span><span class="o">-</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span><span class="o">-</span><span class="n">tool</span>
</pre></div>
</div>
<p>b. <strong>Advanced Installation</strong></p>
<p>Clone the repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">IntelAI</span><span class="o">/</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">transfer</span><span class="o">-</span><span class="n">learning</span>
</pre></div>
</div>
<p>Then either do an editable install to avoid a rebuild and
install after each code change (preferred):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">editable</span> <span class="o">.</span>
</pre></div>
</div>
<p>or build and install a wheel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">dist</span><span class="o">/</span><span class="n">intel_transfer_learning_tool</span><span class="o">-</span><span class="mf">0.4.0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
</li>
<li><p><strong>Additional Feature-Specific Steps</strong></p>
<ul>
<li><p>For distributed/multinode training, follow these additional
<a class="reference internal" href="tlt/distributed/README.html"><span class="doc std std-doc">distributed training instructions</span></a>.</p></li>
<li><p>For TensorFlow text classification, install this additional Python library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">-</span><span class="n">text</span><span class="o">==</span><span class="mf">2.11.0</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><strong>Verify Installation</strong></p>
<p>Verify that your installation was successful by using the following
command, which displays help information about the Intel Transfer Learning Tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlt</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</li>
<li><p><strong>Prepare the Dataset</strong></p>
<p>The Intel Transfer Learning Tool can use datasets from existing dataset catalogs
or custom datasets that you have on your machine.  The following CLI and API
examples use the Intel Transfer Learning Tool’s custom dataset option
(<code class="docutils literal notranslate"><span class="pre">--dataset-dir</span></code>) with the TensorFlow flowers dataset.</p>
<p>Download the flowers dataset from
<a class="reference external" href="https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz">https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz</a>
and extract the files to a folder on your machine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">storage</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">download</span><span class="o">.</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">example_images</span><span class="o">/</span><span class="n">flower_photos</span><span class="o">.</span><span class="n">tgz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xvzf</span> <span class="n">flow_photos</span><span class="o">.</span><span class="n">tgz</span>
</pre></div>
</div>
<p>After extracting the dataset, you should have a <code class="docutils literal notranslate"><span class="pre">flower_photos</span></code> folder with
subfolders for <code class="docutils literal notranslate"><span class="pre">daisy</span></code>, <code class="docutils literal notranslate"><span class="pre">dandelion</span></code>, <code class="docutils literal notranslate"><span class="pre">roses</span></code>, <code class="docutils literal notranslate"><span class="pre">sunflower</span></code>, and <code class="docutils literal notranslate"><span class="pre">tulips</span></code>.</p>
</li>
</ol>
</section>
<section id="run-the-intel-transfer-learning-tool">
<h2>③ Run the Intel Transfer Learning Tool<a class="headerlink" href="#run-the-intel-transfer-learning-tool" title="Permalink to this heading">¶</a></h2>
<p>With the Intel Transfer Learning Tool, you can train AI models with TensorFlow or
PyTorch using either no-code CLI commands at a bash prompt, or low-code API
calls from a Python script. Both approaches provide the same opportunities for
training, evaluation, optimization, and benchmarking. With the CLI, no
programming experience is required, and you’ll need basic Python knowledge to
use the API. Choose the approach that works best for you.</p>
<section id="run-using-the-no-code-cli">
<h3>Run Using the No-Code CLI<a class="headerlink" href="#run-using-the-no-code-cli" title="Permalink to this heading">¶</a></h3>
<p>Follow an example below, or construct your own command. Use <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">--help</span></code> to see
a summary of available CLI commands.  See more detailed information on any
command by using <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">&lt;command&gt;</span> <span class="pre">--help</span></code> (for example, <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">train</span> <span class="pre">--help</span></code>).</p>
<p><strong>List Available Options</strong></p>
<p>Show all available framework, use cases, or models with the <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">list</span></code> command,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlt</span> <span class="nb">list</span> <span class="n">models</span> <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">case</span> <span class="n">image_classification</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">IMAGE</span> <span class="n">CLASSIFICATION</span>
<span class="o">------------------------------</span>
<span class="n">alexnet</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">convnext_base</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">convnext_large</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">convnext_small</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">convnext_tiny</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">densenet121</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">densenet161</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">densenet169</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">densenet201</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">efficientnet_b0</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">efficientnet_b0</span> <span class="p">(</span><span class="n">tensorflow</span><span class="p">)</span>
<span class="n">efficientnet_b1</span> <span class="p">(</span><span class="n">pytorch</span><span class="p">)</span>
<span class="n">efficientnet_b1</span> <span class="p">(</span><span class="n">tensorflow</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="Models.html"><span class="doc std std-doc">full list of supported models</span></a>.</p>
<p><strong>Train a Model</strong></p>
<p>This example uses the CLI to train an image classifier to identify different types of flowers.
Make sure to specify your own file paths for <code class="docutils literal notranslate"><span class="pre">dataset-dir</span></code> and <code class="docutils literal notranslate"><span class="pre">output-dir</span></code>. The <code class="docutils literal notranslate"><span class="pre">dataset-dir</span></code> should
point to the flowers dataset you prepared in an earlier step. For more information on using different
datasets, see the <a class="reference internal" href="examples/cli/README.html"><span class="doc std std-doc">CLI examples</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tlt</span> <span class="n">train</span> <span class="o">-</span><span class="n">f</span> <span class="n">tensorflow</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">name</span> <span class="n">resnet_v1_50</span> <span class="o">--</span><span class="n">dataset</span><span class="o">-</span><span class="nb">dir</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">flower_photos</span> <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="nb">dir</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">output</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span> <span class="n">name</span><span class="p">:</span> <span class="n">resnet_v1_50</span>
<span class="n">Framework</span><span class="p">:</span> <span class="n">tensorflow</span>
<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">tf_flowers</span>
<span class="n">Training</span> <span class="n">epochs</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Dataset</span> <span class="nb">dir</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">flower_photos</span>
<span class="n">Output</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">output</span>
<span class="n">Found</span> <span class="mi">3670</span> <span class="n">files</span> <span class="n">belonging</span> <span class="n">to</span> <span class="mi">5</span> <span class="n">classes</span><span class="o">.</span>
<span class="o">...</span>
<span class="n">Saved</span> <span class="n">model</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="n">resnet_v1_50</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
<p>After training completes, the model is exported to the output directory
specified in your command. The actual directory name is printed out to the
console. A numbered folder is created for each training run.</p>
<p><strong>Next Steps</strong></p>
<p>The training command also evalutes the trained model and prints out accuracy and
loss metrics.  Evaluation can also be called separately using <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">eval</span></code>. The
trained model can also be benchmarked using <code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">benchmark</span></code> or quantized using
<code class="docutils literal notranslate"><span class="pre">tlt</span> <span class="pre">quantize</span></code>.  See the <a class="reference internal" href="examples/cli/README.html"><span class="doc std std-doc">CLI documentation</span></a> for more
examples using the CLI or the <a class="reference internal" href="cli.html"><span class="doc std std-doc">CLI reference</span></a>.</p>
</section>
<section id="run-using-the-low-code-api">
<h3>Run Using the Low-Code API<a class="headerlink" href="#run-using-the-low-code-api" title="Permalink to this heading">¶</a></h3>
<p>The following example trains an image classification model with the TensorFlow
flowers dataset using the API calls from Python.  Additionally, the model is
benchmarked and quantized to INT8 precision for improved inference performance.
You can run the API using a Jupyter notebook. See the <a class="reference internal" href="notebooks/setup.html"><span class="doc std std-doc">notebook setup
instructions</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tlt.datasets</span> <span class="kn">import</span> <span class="n">dataset_factory</span>
<span class="kn">from</span> <span class="nn">tlt.models</span> <span class="kn">import</span> <span class="n">model_factory</span>
<span class="kn">from</span> <span class="nn">tlt.utils.types</span> <span class="kn">import</span> <span class="n">FrameworkType</span><span class="p">,</span> <span class="n">UseCaseType</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Specify the directory where the TensorFlow flowers dataset has been downloaded and extracted</span>
<span class="c1"># (https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz)</span>
<span class="n">dataset_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DATASET_DIR&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;DATASET_DIR&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span> <span class="k">else</span> \
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HOME&quot;</span><span class="p">],</span> <span class="s2">&quot;dataset&quot;</span><span class="p">)</span>

<span class="c1"># Specify a directory for output</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OUTPUT_DIR&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;OUTPUT_DIR&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span> <span class="k">else</span> \
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HOME&quot;</span><span class="p">],</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>

<span class="c1"># Get the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_factory</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;resnet_v1_50&quot;</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="n">FrameworkType</span><span class="o">.</span><span class="n">TENSORFLOW</span><span class="p">)</span>

<span class="c1"># Load and preprocess a dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset_factory</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">dataset_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s2">&quot;flower_photos&quot;</span><span class="p">),</span>
                                       <span class="n">use_case</span><span class="o">=</span><span class="n">UseCaseType</span><span class="o">.</span><span class="n">IMAGE_CLASSIFICATION</span><span class="p">,</span> \
                                       <span class="n">framework</span><span class="o">=</span><span class="n">FrameworkType</span><span class="o">.</span><span class="n">TENSORFLOW</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">image_size</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">shuffle_split</span><span class="p">(</span><span class="n">train_pct</span><span class="o">=</span><span class="mf">.75</span><span class="p">,</span> <span class="n">val_pct</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>

<span class="c1"># Train the model using the dataset</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Evaluate the trained model</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">metric_value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">metrics_names</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">metric_value</span><span class="p">))</span>

<span class="c1"># Export the model</span>
<span class="n">saved_model_dir</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>

<span class="c1"># Create an Intel Neural Compressor config file</span>
<span class="n">inc_config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;inc_config.yaml&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">write_inc_config_file</span><span class="p">(</span><span class="n">inc_config_file</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">accuracy_criterion_relative</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">exit_policy_timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">exit_policy_max_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tuning_workspace</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;nc_workspace&quot;</span><span class="p">))</span>

<span class="c1"># Quantize the trained model</span>
<span class="n">quantization_output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;quantized_model&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">quantization_output</span><span class="p">,</span> <span class="n">inc_config_file</span><span class="p">)</span>

<span class="c1"># Benchmark the trained model using the Intel Neural Compressor config file</span>
<span class="n">model</span><span class="o">.</span><span class="n">benchmark</span><span class="p">(</span><span class="n">quantization_output</span><span class="p">,</span> <span class="n">inc_config_file</span><span class="p">,</span> <span class="s1">&#39;performance&#39;</span><span class="p">)</span>

<span class="c1"># Do graph optimization on the trained model</span>
<span class="n">optimization_output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;optimized_model&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">optimize_graph</span><span class="p">(</span><span class="n">optimization_output</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information on the API see the <a class="reference internal" href="api.html"><span class="doc std std-doc">API Documentation</span></a>.</p>
</section>
</section>
<section id="summary-and-next-steps">
<h2>Summary and Next Steps<a class="headerlink" href="#summary-and-next-steps" title="Permalink to this heading">¶</a></h2>
<p>The Intel Transfer Learning Tool can be used to develop an AI model and export
an Intel-optimized saved model for deployment. The sample CLI and API commands
we’ve presented show how to execute end-to-end transfer learning workflows. For
more details, check out these tutorial Jupyter notebooks, and real-world
reference workflow examples:</p>
<p><strong>Tutorial Jupyter Notebooks</strong></p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Notebook</p></th>
<th class="head"><p>Use Case</p></th>
<th class="head"><p>Framework</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool/tree/main/notebooks/text_classification/tlt_api_tf_text_classification">Text Classification with TensorFlow using the Intel® Transfer Learning Tool</a></p></td>
<td><p>Text Classification</p></td>
<td><p>TensorFlow and the Intel Transfer Learning Tool API</p></td>
<td><p>Demonstrates how to use the Intel Transfer Learning Tool API to fine tune a BERT model from Hugging Face using binary text classification datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool/tree/main/notebooks/text_classification/tlt_api_pyt_text_classification">Text Classification with Pytorch using the Intel® Transfer Learning Tool</a></p></td>
<td><p>Text Classification</p></td>
<td><p>PyTorch and the Intel Transfer Learning Tool API</p></td>
<td><p>Demonstrates how to use the Intel Transfer Learning Tool API to fine tune a BERT model from Hugging Face using binary text classification datasets.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool/tree/main/notebooks/image_classification/tlt_api_tf_image_classification">Image Classification with TensorFlow using Intel® Transfer Learning Tool</a></p></td>
<td><p>Image Classification</p></td>
<td><p>TensorFlow and the Intel Transfer Learning Tool API</p></td>
<td><p>Demonstrates how to use the Intel Transfer Learning Tool API to do transfer learning for image classification using a TensorFlow model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool/tree/main/notebooks/image_classification/tlt_api_pyt_image_classification">Image Classification with PyTorch using Intel® Transfer Learning Tool</a></p></td>
<td><p>Image Classification</p></td>
<td><p>PyTorch and the Intel Transfer Learning Tool API</p></td>
<td><p>Demonstrates how to use the Intel Transfer Learning Tool API to do transfer learning for image classification using a PyTorch model.</p></td>
</tr>
</tbody>
</table>
<p><strong>Real-World Examples</strong></p>
<p>Check out these Reference Kits and Workflows that use Intel Transfer Learning Tool:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning/tree/main/workflows/disease_prediction">Breast Cancer Detection</a></p></li>
<li><p><a class="reference external" href="https://github.com/IntelAI/transfer-learning/tree/main/workflows/vision_anomaly_detection">Anomaly Detection</a></p></li>
</ul>
</section>
<section id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this heading">¶</a></h2>
<p>The Intel Transfer Learning Tool team tracks bugs and enhancement requests using
<a class="reference external" href="https://github.com/IntelAI/transfer-learning-tool/issues">GitHub issues</a>. Before submitting a
suggestion or bug report, search the existing GitHub issues to see if your issue has already been reported.</p>
<p>See <a class="reference internal" href="Legal.html"><span class="doc std std-doc">Legal Information</span></a> for Disclaimers, Trademark, and Licensing information.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Intel® Transfer Learning Tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Models.html" class="btn btn-neutral float-right" title="Intel® Transfer Learning Tool Supported Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Intel Corporation.
      <span class="lastupdated">Last updated on May 23, 2023.
      </span></p>
  </div>

  
*Other names and brands may be claimed as the property of others.
<a href="http://www.intel.com/content/www/us/en/legal/trademarks.html">Trademarks</a>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>